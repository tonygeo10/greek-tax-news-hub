<!doctype html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greek Tax News Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { box-sizing: border-box; }
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .news-card {
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #3b82f6;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .toast {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 50;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            color: white;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        .toast.show { transform: translateX(0); }
        .toast.success { background-color: #059669; }
        .toast.error { background-color: #dc2626; }
        .toast.warning { background-color: #d97706; }
        .toast.info { background-color: #2563eb; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <div class="text-2xl">ğŸ‡¬ğŸ‡·</div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Greek Tax News Hub</h1>
                        <p class="text-sm text-gray-600">Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚ Î‘Î‘Î”Î• & Î¦Î¿ÏÎ¿Î»Î¿Î³Î¹ÎºÎ¬ ÎÎ­Î±</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="refresh-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors">
                        <span id="refresh-icon">ğŸ”„</span>
                        <span>Î‘Î½Î±Î½Î­Ï‰ÏƒÎ·</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <section class="bg-white rounded-lg shadow-sm p-6 mb-8">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Î Î·Î³Î­Ï‚ RSS Î‘Î‘Î”Î•</h2>
            
            <div class="mb-6">
                <h3 class="text-md font-medium text-gray-700 mb-3">Î•Ï€Î¯ÏƒÎ·Î¼ÎµÏ‚ Î Î·Î³Î­Ï‚ Î‘Î‘Î”Î•:</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-3">
                    <button class="popular-feed-btn bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 text-left transition-colors" 
                            data-url="https://www.aade.gr/deltia-typoy-anakoinoseis?format=rss" data-name="Î‘Î‘Î”Î• - Î”ÎµÎ»Ï„Î¯Î± Î¤ÏÏ€Î¿Ï…" data-category="official">
                        <div class="font-medium text-blue-900">Î‘Î‘Î”Î• - Î”ÎµÎ»Ï„Î¯Î± Î¤ÏÏ€Î¿Ï…</div>
                        <div class="text-sm text-blue-700">Î•Ï€Î¯ÏƒÎ·Î¼ÎµÏ‚ Î±Î½Î±ÎºÎ¿Î¹Î½ÏÏƒÎµÎ¹Ï‚ & Î´ÎµÎ»Ï„Î¯Î± Ï„ÏÏ€Î¿Ï…</div>
                    </button>
                    <button class="popular-feed-btn bg-green-50 hover:bg-green-100 border border-green-200 rounded-lg p-3 text-left transition-colors" 
                            data-url="https://www.aade.gr/nea-kai-enimerosi?format=rss" data-name="Î‘Î‘Î”Î• - ÎÎ­Î± & Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·" data-category="official">
                        <div class="font-medium text-green-900">Î‘Î‘Î”Î• - ÎÎ­Î± & Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·</div>
                        <div class="text-sm text-green-700">Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î½Î­Î± ÎºÎ±Î¹ ÎµÎ½Î·Î¼ÎµÏÏÏƒÎµÎ¹Ï‚</div>
                    </button>
                </div>
                <button id="add-all-popular" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg transition-colors">
                    Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î Î·Î³ÏÎ½ Î‘Î‘Î”Î•
                </button>
            </div>

            <!-- Manual Add -->
            <div class="border-t pt-6">
                <h3 class="text-md font-medium text-gray-700 mb-3">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î†Î»Î»Î·Ï‚ Î Î·Î³Î®Ï‚ Î‘Î‘Î”Î•:</h3>
                <div class="flex flex-col sm:flex-row gap-3">
                    <input type="url" id="custom-rss-url" placeholder="https://www.aade.gr/...?format=rss" 
                           class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <input type="text" id="custom-rss-name" placeholder="ÎŒÎ½Î¿Î¼Î± Ï€Î·Î³Î®Ï‚" 
                           class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <button id="add-custom-feed" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                        Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·
                    </button>
                </div>
                <p class="text-sm text-gray-500 mt-2">Î£Ï…Î¼Î²Î¿Ï…Î»Î®: ÎŸÎ¹ Ï€Î·Î³Î­Ï‚ Î‘Î‘Î”Î• Î»Î®Î³Î¿Ï…Î½ ÏƒÎµ ?format=rss</p>
            </div>
        </section>

        <!-- Articles Grid -->
        <section id="articles-section">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold text-gray-900">Î†ÏÎ¸ÏÎ± <span id="article-count" class="text-gray-500">(0)</span></h2>
            </div>

            <!-- Loading State -->
            <div id="loading-state" class="hidden text-center py-12">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-gray-600">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· ÎµÎ¹Î´Î®ÏƒÎµÏ‰Î½ Î±Ï€ÏŒ Î‘Î‘Î”Î•...</p>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="text-center py-12">
                <div class="text-6xl mb-4">ğŸ›ï¸</div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¬ÏÎ¸ÏÎ±</h3>
                <p class="text-gray-600 mb-6">Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€Î·Î³Î­Ï‚ RSS Î±Ï€ÏŒ Ï„Î·Î½ Î‘Î‘Î”Î• Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ</p>
                <button id="add-first-feeds" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors">
                    Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î Î·Î³ÏÎ½ Î‘Î‘Î”Î•
                </button>
            </div>

            <!-- Articles Grid -->
            <div id="articles-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Articles will be inserted here -->
            </div>
        </section>
    </main>

    <script>
        // Simple RSS Parser for AADE feeds
        class RSSParser {
            static async parseRSSFeed(url, name) {
                console.log('ğŸ“¡ Fetching AADE RSS from:', name);
                
                try {
                    // AADE feeds should work directly without CORS issues
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const text = await response.text();
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(text, 'text/xml');
                    
                    // Check for parsing errors
                    const parseError = xmlDoc.querySelector('parsererror');
                    if (parseError) {
                        throw new Error('Invalid XML format from AADE feed');
                    }
                    
                    // Parse RSS items
                    const items = xmlDoc.querySelectorAll('item');
                    const articles = [];
                    
                    console.log(`Found ${items.length} items in AADE RSS feed`);
                    
                    items.forEach(item => {
                        const title = item.querySelector('title')?.textContent?.trim();
                        const description = item.querySelector('description')?.textContent?.trim();
                        const link = item.querySelector('link')?.textContent?.trim();
                        const pubDate = item.querySelector('pubDate')?.textContent?.trim();
                        
                        if (title && link) {
                            articles.push({
                                title: title,
                                description: description || 'Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®',
                                source_url: link,
                                pub_date: pubDate ? new Date(pubDate).toISOString() : new Date().toISOString(),
                                read: false,
                                bookmarked: false,
                                created_at: new Date().toISOString(),
                                source: name,
                                category: 'official',
                                feed_id: url
                            });
                        }
                    });
                    
                    console.log(`âœ… Successfully parsed ${articles.length} articles from ${name}`);
                    return articles;
                    
                } catch (error) {
                    console.error(`âŒ Failed to fetch from AADE ${name}:`, error);
                    
                    // Fallback: Try with CORS proxy for AADE
                    try {
                        console.log('Trying CORS proxy for AADE...');
                        const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;
                        const response = await fetch(proxyUrl);
                        
                        if (response.ok) {
                            const data = await response.json();
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(data.contents, 'text/xml');
                            const items = xmlDoc.querySelectorAll('item');
                            
                            const articles = [];
                            items.forEach(item => {
                                const title = item.querySelector('title')?.textContent?.trim();
                                const description = item.querySelector('description')?.textContent?.trim();
                                const link = item.querySelector('link')?.textContent?.trim();
                                const pubDate = item.querySelector('pubDate')?.textContent?.trim();
                                
                                if (title && link) {
                                    articles.push({
                                        title: title,
                                        description: description || 'Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®',
                                        source_url: link,
                                        pub_date: pubDate ? new Date(pubDate).toISOString() : new Date().toISOString(),
                                        read: false,
                                        bookmarked: false,
                                        created_at: new Date().toISOString(),
                                        source: name,
                                        category: 'official',
                                        feed_id: url
                                    });
                                }
                            });
                            
                            console.log(`âœ… Fallback fetched ${articles.length} articles from ${name}`);
                            return articles;
                        }
                    } catch (fallbackError) {
                        console.error('âŒ Fallback also failed:', fallbackError);
                    }
                    
                    throw new Error(`Î”ÎµÎ½ Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„Î® Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î±Ï€ÏŒ ${name}`);
                }
            }
        }

        // Data Storage with localStorage
        class DataStorage {
            constructor() {
                this.storageKey = 'greekTaxNewsData';
            }
            
            async init() {
                return { isOk: true };
            }
            
            async getAll() {
                const stored = localStorage.getItem(this.storageKey);
                if (stored) {
                    const data = JSON.parse(stored);
                    return { isOk: true, data: data.articles || [] };
                }
                return { isOk: true, data: [] };
            }
            
            async create(article) {
                const stored = localStorage.getItem(this.storageKey);
                const data = stored ? JSON.parse(stored) : { articles: [], feeds: [] };
                
                article.id = 'article_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                data.articles.push(article);
                
                localStorage.setItem(this.storageKey, JSON.stringify(data));
                return { isOk: true };
            }
            
            async update(updatedArticle) {
                const stored = localStorage.getItem(this.storageKey);
                if (stored) {
                    const data = JSON.parse(stored);
                    const index = data.articles.findIndex(a => a.id === updatedArticle.id);
                    if (index !== -1) {
                        data.articles[index] = updatedArticle;
                        localStorage.setItem(this.storageKey, JSON.stringify(data));
                    }
                }
                return { isOk: true };
            }
            
            async delete(article) {
                const stored = localStorage.getItem(this.storageKey);
                if (stored) {
                    const data = JSON.parse(stored);
                    data.articles = data.articles.filter(a => a.id !== article.id);
                    localStorage.setItem(this.storageKey, JSON.stringify(data));
                }
                return { isOk: true };
            }
        }

        // Main Application
        class GreekTaxNewsApp {
            constructor() {
                this.articles = [];
                this.feeds = new Map();
                this.isLoading = false;
                this.dataStorage = new DataStorage();
                
                this.aadeFeeds = [
                    { url: 'https://www.aade.gr/deltia-typoy-anakoinoseis?format=rss', name: 'Î‘Î‘Î”Î• - Î”ÎµÎ»Ï„Î¯Î± Î¤ÏÏ€Î¿Ï…', category: 'official' },
                    { url: 'https://www.aade.gr/nea-kai-enimerosi?format=rss', name: 'Î‘Î‘Î”Î• - ÎÎ­Î± & Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·', category: 'official' }
                ];
                
                this.init();
            }
            
            async init() {
                console.log('ğŸš€ Initializing Greek Tax News Hub for AADE...');
                
                await this.dataStorage.init();
                const result = await this.dataStorage.getAll();
                this.articles = result.data || [];
                
                this.loadFeedsFromStorage();
                this.setupEventListeners();
                this.renderArticles();
                
                console.log('âœ… App initialized with', this.articles.length, 'articles');
            }
            
            loadFeedsFromStorage() {
                const stored = localStorage.getItem('greekTaxNewsData');
                if (stored) {
                    const data = JSON.parse(stored);
                    if (data.feeds) {
                        data.feeds.forEach(feed => {
                            this.feeds.set(feed.url, feed);
                        });
                    }
                }
            }
            
            saveFeedsToStorage() {
                const stored = localStorage.getItem('greekTaxNewsData');
                const data = stored ? JSON.parse(stored) : { articles: [], feeds: [] };
                data.feeds = Array.from(this.feeds.values());
                localStorage.setItem('greekTaxNewsData', JSON.stringify(data));
            }
            
            setupEventListeners() {
                document.getElementById('refresh-btn').addEventListener('click', () => this.refreshAllFeeds());
                
                document.querySelectorAll('.popular-feed-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const url = e.currentTarget.dataset.url;
                        const name = e.currentTarget.dataset.name;
                        const category = e.currentTarget.dataset.category;
                        this.addFeed(url, name, category);
                    });
                });
                
                document.getElementById('add-all-popular').addEventListener('click', () => this.addAllAADEFeeds());
                document.getElementById('add-first-feeds').addEventListener('click', () => this.addAllAADEFeeds());
                
                document.getElementById('add-custom-feed').addEventListener('click', () => this.addCustomFeed());
            }
            
            async addFeed(url, name, category = 'official') {
                if (this.feeds.has(url)) {
                    this.showNotification('Î— Ï€Î·Î³Î® Î‘Î‘Î”Î• Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·!', 'warning');
                    return;
                }
                
                const feed = {
                    url: url,
                    name: name,
                    category: category,
                    enabled: true,
                    lastFetch: null,
                    status: 'active'
                };
                
                this.feeds.set(url, feed);
                this.saveFeedsToStorage();
                this.showNotification(`Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Ï€Î·Î³Î® Î‘Î‘Î”Î•: ${name}`, 'success');
                
                await this.fetchFeedArticles(feed);
            }
            
            async addCustomFeed() {
                const urlInput = document.getElementById('custom-rss-url');
                const nameInput = document.getElementById('custom-rss-name');
                
                const url = urlInput.value.trim();
                const name = nameInput.value.trim();
                
                if (!url || !name) {
                    this.showNotification('Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ URL ÎºÎ±Î¹ ÏŒÎ½Î¿Î¼Î± Ï€Î·Î³Î®Ï‚ Î‘Î‘Î”Î•', 'error');
                    return;
                }
                
                if (!url.includes('aade.gr')) {
                    this.showNotification('Î Î±ÏÎ±ÎºÎ±Î»Ï Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Î¼ÏŒÎ½Î¿ Ï€Î·Î³Î­Ï‚ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏ€Î¯ÏƒÎ·Î¼Î· Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± Î‘Î‘Î”Î• (aade.gr)', 'warning');
                    return;
                }
                
                await this.addFeed(url, name, 'official');
                
                urlInput.value = '';
                nameInput.value = '';
            }
            
            async addAllAADEFeeds() {
                let addedCount = 0;
                
                this.showNotification('Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Ï€Î·Î³ÏÎ½ Î‘Î‘Î”Î•...', 'info');
                
                for (const feed of this.aadeFeeds) {
                    if (!this.feeds.has(feed.url)) {
                        await this.addFeed(feed.url, feed.name, feed.category);
                        addedCount++;
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }
                }
                
                if (addedCount > 0) {
                    this.showNotification(`Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎ±Î½ ${addedCount} Î½Î­ÎµÏ‚ Ï€Î·Î³Î­Ï‚ Î‘Î‘Î”Î•!`, 'success');
                } else {
                    this.showNotification('ÎŒÎ»ÎµÏ‚ Î¿Î¹ Ï€Î·Î³Î­Ï‚ Î‘Î‘Î”Î• Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î®Î´Î·', 'info');
                }
            }
            
            async refreshAllFeeds() {
                if (this.isLoading) {
                    this.showNotification('Î— Î±Î½Î±Î½Î­Ï‰ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î®Î´Î· ÏƒÎµ ÎµÎ¾Î­Î»Î¹Î¾Î·...', 'info');
                    return;
                }
                
                const enabledFeeds = Array.from(this.feeds.values()).filter(feed => feed.enabled);
                
                if (enabledFeeds.length === 0) {
                    this.showNotification('Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÎ½ÎµÏÎ³Î­Ï‚ Ï€Î·Î³Î­Ï‚ Î‘Î‘Î”Î• Î³Î¹Î± Î±Î½Î±Î½Î­Ï‰ÏƒÎ·', 'warning');
                    return;
                }
                
                this.setLoading(true);
                this.showNotification('Î‘Î½Î±Î½Î­Ï‰ÏƒÎ· Ï€Î·Î³ÏÎ½ Î‘Î‘Î”Î•...', 'info');
                
                let successCount = 0;
                let totalNewArticles = 0;
                
                for (const feed of enabledFeeds) {
                    try {
                        const newArticles = await this.fetchFeedArticles(feed);
                        if (newArticles > 0) {
                            successCount++;
                            totalNewArticles += newArticles;
                        }
                        await new Promise(resolve => setTimeout(resolve, 800));
                    } catch (error) {
                        console.error(`Failed to refresh AADE feed ${feed.name}:`, error);
                    }
                }
                
                this.setLoading(false);
                
                if (totalNewArticles > 0) {
                    this.showNotification(`Î’ÏÎ­Î¸Î·ÎºÎ±Î½ ${totalNewArticles} Î½Î­ÎµÏ‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ ${successCount} Ï€Î·Î³Î­Ï‚ Î‘Î‘Î”Î•!`, 'success');
                } else {
                    this.showNotification('Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î½Î­ÎµÏ‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î‘Î‘Î”Î•', 'info');
                }
            }
            
            async fetchFeedArticles(feed) {
                try {
                    console.log(`ğŸ”„ Fetching AADE articles from: ${feed.name}`);
                    
                    const articles = await RSSParser.parseRSSFeed(feed.url, feed.name);
                    let newArticlesCount = 0;
                    
                    for (const article of articles) {
                        const existingArticle = this.articles.find(a => 
                            a.title === article.title && a.source === article.source
                        );
                        
                        if (!existingArticle) {
                            await this.dataStorage.create(article);
                            this.articles.push(article);
                            newArticlesCount++;
                        }
                    }
                    
                    feed.lastFetch = new Date().toISOString();
                    console.log(`âœ… Added ${newArticlesCount} new AADE articles from ${feed.name}`);
                    
                    this.renderArticles();
                    return newArticlesCount;
                    
                } catch (error) {
                    console.error(`âŒ Failed to fetch from AADE ${feed.name}:`, error);
                    this.showNotification(`Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î±Ï€ÏŒ ${feed.name}`, 'error');
                    return 0;
                }
            }
            
            renderArticles() {
                const grid = document.getElementById('articles-grid');
                const emptyState = document.getElementById('empty-state');
                const articleCount = document.getElementById('article-count');
                
                if (this.articles.length === 0) {
                    grid.innerHTML = '';
                    emptyState.classList.remove('hidden');
                    articleCount.textContent = '(0)';
                    return;
                }
                
                emptyState.classList.add('hidden');
                
                const sortedArticles = [...this.articles].sort((a, b) => 
                    new Date(b.pub_date) - new Date(a.pub_date)
                );
                
                grid.innerHTML = sortedArticles.map(article => this.createArticleCard(article)).join('');
                articleCount.textContent = `(${sortedArticles.length})`;
                
                this.setupArticleEventListeners();
            }
            
            createArticleCard(article) {
                const publishDate = new Date(article.pub_date).toLocaleDateString('el-GR', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                return `
                    <article class="news-card bg-white rounded-lg shadow-sm p-6 fade-in">
                        <div class="flex justify-between items-start mb-3">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800">
                                ${article.source}
                            </span>
                            <button class="bookmark-btn text-gray-400 hover:text-yellow-500 transition-colors" 
                                    data-article-id="${article.id}" title="Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î± Î±Î³Î±Ï€Î·Î¼Î­Î½Î±">
                                ${article.bookmarked ? 'â­' : 'â˜†'}
                            </button>
                        </div>
                        
                        <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">
                            <a href="${article.source_url}" target="_blank" rel="noopener noreferrer" 
                               class="hover:text-blue-600 transition-colors">
                                ${article.title}
                            </a>
                        </h3>
                        
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3">${article.description}</p>
                        
                        <div class="flex justify-between items-center text-sm text-gray-500">
                            <time datetime="${article.pub_date}">${publishDate}</time>
                            <a href="${article.source_url}" target="_blank" rel="noopener noreferrer" 
                               class="text-blue-600 hover:text-blue-800 transition-colors">
                                Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ ÏƒÏ„Î·Î½ Î‘Î‘Î”Î• â†’
                            </a>
                        </div>
                    </article>
                `;
            }
            
            setupArticleEventListeners() {
                document.querySelectorAll('.bookmark-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.preventDefault();
                        const articleId = e.target.dataset.articleId;
                        const article = this.articles.find(a => a.id === articleId);
                        if (article) {
                            article.bookmarked = !article.bookmarked;
                            await this.dataStorage.update(article);
                            this.renderArticles();
                            this.showNotification(
                                article.bookmarked ? 'Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ ÏƒÏ„Î± Î±Î³Î±Ï€Î·Î¼Î­Î½Î±' : 'Î‘Ï†Î±Î¹ÏÎ­Î¸Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î± Î±Î³Î±Ï€Î·Î¼Î­Î½Î±', 
                                'success'
                            );
                        }
                    });
                });
            }
            
            setLoading(loading) {
                this.isLoading = loading;
                const refreshBtn = document.getElementById('refresh-btn');
                const refreshIcon = document.getElementById('refresh-icon');
                const loadingState = document.getElementById('loading-state');
                
                if (loading) {
                    refreshBtn.disabled = true;
                    refreshBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    refreshIcon.classList.add('animate-spin');
                    loadingState.classList.remove('hidden');
                } else {
                    refreshBtn.disabled = false;
                    refreshBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    refreshIcon.classList.remove('animate-spin');
                    loadingState.classList.add('hidden');
                }
            }
            
            showNotification(message, type = 'info') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.classList.add('show');
                }, 100);
                
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }, 4000);
            }
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            window.greekTaxNewsApp = new GreekTaxNewsApp();
        });
    </script>
</body>
</html>
